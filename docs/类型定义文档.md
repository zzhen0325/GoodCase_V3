# Gooodcase ç±»å‹å®šä¹‰æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [åŸºç¡€ç±»å‹](#åŸºç¡€ç±»å‹)
3. [æ ¸å¿ƒå®ä½“ç±»å‹](#æ ¸å¿ƒå®ä½“ç±»å‹)
4. [æ•°æ®åº“æ–‡æ¡£ç±»å‹](#æ•°æ®åº“æ–‡æ¡£ç±»å‹)
5. [æœç´¢å’Œè¿‡æ»¤ç±»å‹](#æœç´¢å’Œè¿‡æ»¤ç±»å‹)
6. [åº”ç”¨çŠ¶æ€ç±»å‹](#åº”ç”¨çŠ¶æ€ç±»å‹)
7. [APIå’Œå“åº”ç±»å‹](#apiå’Œå“åº”ç±»å‹)
8. [UIå’Œäº¤äº’ç±»å‹](#uiå’Œäº¤äº’ç±»å‹)
9. [å·¥å…·ç±»å‹å’Œå¸¸é‡](#å·¥å…·ç±»å‹å’Œå¸¸é‡)
10. [é”™è¯¯å¤„ç†ç±»å‹](#é”™è¯¯å¤„ç†ç±»å‹)
11. [ç±»å‹å®ˆå«å‡½æ•°](#ç±»å‹å®ˆå«å‡½æ•°)
12. [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)

---

## æ¦‚è¿°

### ğŸ¯ æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº† Gooodcase å›¾ç‰‡ç®¡ç†ç³»ç»Ÿä¸­æ‰€æœ‰çš„ TypeScript ç±»å‹å®šä¹‰ï¼ŒåŒ…æ‹¬æ¥å£ã€ç±»å‹åˆ«åã€æšä¸¾å’Œå¸¸é‡ã€‚è¿™äº›ç±»å‹å®šä¹‰ç¡®ä¿äº†ä»£ç çš„ç±»å‹å®‰å…¨æ€§å’Œå¼€å‘ä½“éªŒã€‚

### ğŸ“ æ–‡ä»¶ä½ç½®

- **ä¸»è¦ç±»å‹å®šä¹‰**: `types/index.ts`
- **ç»„ä»¶ç‰¹å®šç±»å‹**: å„ç»„ä»¶æ–‡ä»¶ä¸­çš„å±€éƒ¨ç±»å‹
- **æ•°æ®åº“ç›¸å…³ç±»å‹**: `lib/database.ts` ä¸­çš„æ‰©å±•ç±»å‹

### ğŸ—ï¸ è®¾è®¡åŸåˆ™

1. **ç±»å‹å®‰å…¨**: æ‰€æœ‰æ•°æ®ç»“æ„éƒ½æœ‰æ˜ç¡®çš„ç±»å‹å®šä¹‰
2. **å¯æ‰©å±•æ€§**: æ¥å£è®¾è®¡æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
3. **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„å‘½åè§„èŒƒå’Œç»“æ„æ¨¡å¼
4. **æ–‡æ¡£åŒ–**: æ¯ä¸ªç±»å‹éƒ½æœ‰æ¸…æ™°çš„æ³¨é‡Šè¯´æ˜
5. **å¤ç”¨æ€§**: é€šè¿‡æ³›å‹å’Œç»§æ‰¿å‡å°‘é‡å¤å®šä¹‰

---

## åŸºç¡€ç±»å‹

### ğŸ”§ BaseEntity æ¥å£

æ‰€æœ‰å®ä½“çš„åŸºç¡€æ¥å£ï¼Œæä¾›é€šç”¨çš„æ ‡è¯†å’Œæ—¶é—´æˆ³å­—æ®µã€‚

```typescript
export interface BaseEntity {
  id: string;           // å”¯ä¸€æ ‡è¯†ç¬¦
  createdAt: Date;      // åˆ›å»ºæ—¶é—´
  updatedAt: Date;      // æ›´æ–°æ—¶é—´
}
```

**ä½¿ç”¨åœºæ™¯**:
- ä½œä¸ºå…¶ä»–å®ä½“æ¥å£çš„åŸºç¡€
- æä¾›ç»Ÿä¸€çš„æ—¶é—´æˆ³ç®¡ç†
- æ”¯æŒæ•°æ®ç‰ˆæœ¬æ§åˆ¶

### ğŸ¨ é¢œè‰²ä¸»é¢˜ç±»å‹

å®šä¹‰åº”ç”¨ä¸­çš„é¢œè‰²ä¸»é¢˜ç³»ç»Ÿã€‚

```typescript
export interface ColorTheme {
  name: string;         // ä¸»é¢˜åç§°
  primary: string;      // ä¸»è‰²è°ƒ
  secondary: string;    // è¾…åŠ©è‰²
  accent: string;       // å¼ºè°ƒè‰²
  bg: string;          // èƒŒæ™¯è‰²
  text: string;        // æ–‡å­—è‰²
}
```

**é¢„å®šä¹‰é¢œè‰²å¸¸é‡**:
```typescript
export const AVAILABLE_COLORS = [
  '#ef4444', '#f97316', '#f59e0b', '#eab308',
  '#84cc16', '#22c55e', '#10b981', '#14b8a6',
  '#06b6d4', '#0ea5e9', '#3b82f6', '#6366f1',
  '#8b5cf6', '#a855f7', '#d946ef', '#ec4899',
  '#f43f5e', '#64748b', '#6b7280', '#374151',
] as const;
```

**é¢„å®šä¹‰ä¸»é¢˜**:
- `default`: è“è‰²ä¸»é¢˜
- `warm`: æš–è‰²è°ƒä¸»é¢˜
- `cool`: å†·è‰²è°ƒä¸»é¢˜
- `nature`: è‡ªç„¶ç»¿è‰²ä¸»é¢˜

---

## æ ¸å¿ƒå®ä½“ç±»å‹

### ğŸ–¼ï¸ ImageData æ¥å£

å›¾ç‰‡æ•°æ®çš„æ ¸å¿ƒç±»å‹å®šä¹‰ã€‚

```typescript
export interface ImageData {
  id: string;              // å›¾ç‰‡å”¯ä¸€æ ‡è¯†
  url: string;             // å›¾ç‰‡URL
  title: string;           // å›¾ç‰‡æ ‡é¢˜
  prompts: Prompt[];       // å…³è”çš„æç¤ºè¯åˆ—è¡¨
  tags: Tag[];            // å…³è”çš„æ ‡ç­¾åˆ—è¡¨
  createdAt: string;       // åˆ›å»ºæ—¶é—´ï¼ˆISOå­—ç¬¦ä¸²ï¼‰
  updatedAt: string;       // æ›´æ–°æ—¶é—´ï¼ˆISOå­—ç¬¦ä¸²ï¼‰
  usageCount?: number;     // ä½¿ç”¨æ¬¡æ•°ï¼ˆå¯é€‰ï¼‰
  isLocal?: boolean;       // æ˜¯å¦ä¸ºæœ¬åœ°æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
  isUploading?: boolean;   // æ˜¯å¦æ­£åœ¨ä¸Šä¼ ï¼ˆå¯é€‰ï¼‰
}
```

**å­—æ®µè¯´æ˜**:
- `prompts`: æ”¯æŒå¤šä¸ªæç¤ºè¯å—çš„å¤åˆç»“æ„
- `tags`: æ”¯æŒå¤šæ ‡ç­¾åˆ†ç±»å’Œè¿‡æ»¤
- `usageCount`: ç”¨äºç»Ÿè®¡å’Œæ’åº
- `isLocal/isUploading`: æ”¯æŒä¸Šä¼ çŠ¶æ€ç®¡ç†

### ğŸ·ï¸ Tag æ¥å£

æ ‡ç­¾ç³»ç»Ÿçš„æ ¸å¿ƒç±»å‹ã€‚

```typescript
export interface Tag {
  id: string;              // æ ‡ç­¾å”¯ä¸€æ ‡è¯†
  name: string;            // æ ‡ç­¾åç§°
  color: string;           // æ ‡ç­¾é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰
  groupId: string;         // æ‰€å±åˆ†ç»„IDï¼ˆå¿…å¡«ï¼‰
  order?: number;          // åœ¨åˆ†ç»„å†…çš„æ’åºä½ç½®
  usageCount?: number;     // ä½¿ç”¨æ¬¡æ•°ç»Ÿè®¡
  createdAt?: string;      // åˆ›å»ºæ—¶é—´
  updatedAt?: string;      // æ›´æ–°æ—¶é—´
}
```

**è®¾è®¡ç‰¹ç‚¹**:
- å¼ºåˆ¶åˆ†ç»„å½’å±ï¼ˆ`groupId` å¿…å¡«ï¼‰
- æ”¯æŒè‡ªå®šä¹‰æ’åº
- è‡ªåŠ¨ç»Ÿè®¡ä½¿ç”¨é¢‘ç‡
- é¢œè‰²å¯è§†åŒ–æ ‡è¯†

### ğŸ“ Prompt æ¥å£

æç¤ºè¯çš„åŸºç¡€ç±»å‹å®šä¹‰ã€‚

```typescript
export interface Prompt {
  id: string;              // æç¤ºè¯å”¯ä¸€æ ‡è¯†
  title: string;           // æç¤ºè¯æ ‡é¢˜
  content: string;         // æç¤ºè¯å†…å®¹
  color: string;           // æ˜¾ç¤ºé¢œè‰²
  order: number;           // æ’åºä½ç½®
  createdAt?: string;      // åˆ›å»ºæ—¶é—´
  updatedAt?: string;      // æ›´æ–°æ—¶é—´
}
```

### ğŸ§© PromptBlock æ¥å£

æç¤ºè¯å—çš„æ‰©å±•ç±»å‹ï¼Œæ”¯æŒæ›´çµæ´»çš„ç»„ç»‡æ–¹å¼ã€‚

```typescript
export interface PromptBlock {
  id: string;              // å—å”¯ä¸€æ ‡è¯†
  text: string;            // å—å†…å®¹
  color?: string;          // å¯é€‰é¢œè‰²
  title?: string;          // å¯é€‰æ ‡é¢˜
  createdAt?: string;      // åˆ›å»ºæ—¶é—´
  updatedAt?: string;      // æ›´æ–°æ—¶é—´
}
```

### ğŸ“ TagGroup æ¥å£

æ ‡ç­¾åˆ†ç»„ç®¡ç†ç±»å‹ã€‚

```typescript
export interface TagGroup {
  id: string;              // åˆ†ç»„å”¯ä¸€æ ‡è¯†
  name: string;            // åˆ†ç»„åç§°
  color: string;           // åˆ†ç»„é¢œè‰²
  order?: number;          // è‡ªå®šä¹‰æ’åºï¼ˆæ•°å€¼è¶Šå°è¶Šé å‰ï¼‰
  tagCount?: number;       // åŒ…å«çš„æ ‡ç­¾æ•°é‡
  createdAt?: string;      // åˆ›å»ºæ—¶é—´
  updatedAt?: string;      // æ›´æ–°æ—¶é—´
}
```

---

## æ•°æ®åº“æ–‡æ¡£ç±»å‹

### ğŸ—„ï¸ Firestore æ–‡æ¡£ç±»å‹

ä¸“é—¨ç”¨äº Firestore æ•°æ®åº“å­˜å‚¨çš„æ–‡æ¡£ç»“æ„ã€‚

#### ImageDocument

```typescript
export interface ImageDocument {
  id?: string;             // æ–‡æ¡£IDï¼ˆå¯é€‰ï¼Œç”±Firestoreç”Ÿæˆï¼‰
  url: string;             // å›¾ç‰‡URL
  thumbnailUrl?: string;   // ç¼©ç•¥å›¾URLï¼ˆå¯é€‰ï¼‰
  title: string;           // å›¾ç‰‡æ ‡é¢˜
  description?: string;    // å›¾ç‰‡æè¿°ï¼ˆå¯é€‰ï¼‰
  tags: string[];          // æ ‡ç­¾IDæ•°ç»„
  prompt?: string;         // æç¤ºè¯æ–‡æœ¬
  width: number;           // å›¾ç‰‡å®½åº¦
  height: number;          // å›¾ç‰‡é«˜åº¦
  fileSize: number;        // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  format: string;          // æ–‡ä»¶æ ¼å¼
  colorSpace?: string;     // è‰²å½©ç©ºé—´ï¼ˆå¯é€‰ï¼‰
  hasTransparency?: boolean; // æ˜¯å¦æœ‰é€æ˜åº¦ï¼ˆå¯é€‰ï¼‰
  createdAt: any;          // Firestore Timestamp
  updatedAt: any;          // Firestore Timestamp
}
```

#### TagDocument

```typescript
export interface TagDocument {
  id?: string;             // æ–‡æ¡£ID
  name: string;            // æ ‡ç­¾åç§°
  color: string;           // æ ‡ç­¾é¢œè‰²
  groupId?: string;        // æ‰€å±åˆ†ç»„ID
  usageCount: number;      // ä½¿ç”¨æ¬¡æ•°
  createdAt: any;          // Firestore Timestamp
  updatedAt: any;          // Firestore Timestamp
}
```

#### TagGroupDocument

```typescript
export interface TagGroupDocument {
  id?: string;             // æ–‡æ¡£ID
  name: string;            // åˆ†ç»„åç§°
  color: string;           // åˆ†ç»„é¢œè‰²
  description?: string;    // åˆ†ç»„æè¿°ï¼ˆå¯é€‰ï¼‰
  tagCount: number;        // åŒ…å«çš„æ ‡ç­¾æ•°é‡
  createdAt: any;          // Firestore Timestamp
  updatedAt: any;          // Firestore Timestamp
}
```

#### PromptDocument

```typescript
export interface PromptDocument {
  id?: string;             // æ–‡æ¡£ID
  text: string;            // æç¤ºè¯æ–‡æœ¬
  category?: string;       // åˆ†ç±»ï¼ˆå¯é€‰ï¼‰
  tags: string[];          // å…³è”æ ‡ç­¾IDæ•°ç»„
  usageCount: number;      // ä½¿ç”¨æ¬¡æ•°
  isTemplate: boolean;     // æ˜¯å¦ä¸ºæ¨¡æ¿
  color?: string;          // æ˜¾ç¤ºé¢œè‰²ï¼ˆå¯é€‰ï¼‰
  imageId?: string;        // å…³è”çš„å›¾ç‰‡IDï¼ˆå¯é€‰ï¼‰
  createdAt: any;          // Firestore Timestamp
  updatedAt: any;          // Firestore Timestamp
}
```

**è®¾è®¡è¯´æ˜**:
- ä½¿ç”¨ `any` ç±»å‹è¡¨ç¤º Firestore Timestamp
- æ”¯æŒå¯é€‰å­—æ®µä»¥é€‚åº”ä¸åŒç‰ˆæœ¬çš„æ•°æ®
- åŒ…å«ç»Ÿè®¡å­—æ®µç”¨äºæ€§èƒ½ä¼˜åŒ–

---

## æœç´¢å’Œè¿‡æ»¤ç±»å‹

### ğŸ” SearchFilters æ¥å£

æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½çš„å‚æ•°å®šä¹‰ã€‚

```typescript
export interface SearchFilters {
  query: string;           // æœç´¢å…³é”®è¯
  tags: string[];          // é€‰ä¸­çš„æ ‡ç­¾IDæ•°ç»„
  dateRange?: {            // æ—¥æœŸèŒƒå›´è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰
    start: Date;
    end: Date;
  };
  sizeRange?: {            // å°ºå¯¸èŒƒå›´è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰
    minWidth?: number;
    maxWidth?: number;
    minHeight?: number;
    maxHeight?: number;
  };
  sortBy: 'createdAt' | 'updatedAt' | 'title' | 'size'; // æ’åºå­—æ®µ
  sortOrder: 'asc' | 'desc'; // æ’åºæ–¹å‘
}
```

**é»˜è®¤æœç´¢è¿‡æ»¤å™¨**:
```typescript
export const DEFAULT_SEARCH_FILTERS: SearchFilters = {
  query: '',
  tags: [],
  sortBy: 'createdAt',
  sortOrder: 'desc',
};
```

### ğŸ“„ Pagination æ¥å£

åˆ†é¡µåŠŸèƒ½çš„å‚æ•°å’ŒçŠ¶æ€å®šä¹‰ã€‚

```typescript
export interface Pagination {
  page: number;            // å½“å‰é¡µç 
  limit: number;           // æ¯é¡µæ•°é‡
  total: number;           // æ€»æ•°é‡
  hasNext: boolean;        // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
  hasPrev: boolean;        // æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
  startAfter?: any;        // Firestore åˆ†é¡µæ¸¸æ ‡
}
```

### ğŸ“Š SearchResult æ¥å£

æœç´¢ç»“æœçš„å®Œæ•´æ•°æ®ç»“æ„ã€‚

```typescript
export interface SearchResult {
  images: ImageData[];     // æœç´¢åˆ°çš„å›¾ç‰‡åˆ—è¡¨
  pagination: Pagination;  // åˆ†é¡µä¿¡æ¯
  filters: SearchFilters;  // å½“å‰è¿‡æ»¤æ¡ä»¶
  total: number;           // æ€»ç»“æœæ•°é‡
  searchTime: number;      // æœç´¢è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
}
```

---

## åº”ç”¨çŠ¶æ€ç±»å‹

### ğŸª AppState æ¥å£

åº”ç”¨çš„å…¨å±€çŠ¶æ€å®šä¹‰ã€‚

```typescript
export interface AppState {
  images: ImageData[];           // æ‰€æœ‰å›¾ç‰‡æ•°æ®
  filteredImages: ImageData[];   // è¿‡æ»¤åçš„å›¾ç‰‡æ•°æ®
  tags: Tag[];                   // æ‰€æœ‰æ ‡ç­¾æ•°æ®
  searchFilters: SearchFilters;  // å½“å‰æœç´¢è¿‡æ»¤æ¡ä»¶
  isLoading: boolean;            // åŠ è½½çŠ¶æ€
  error: string | null;          // é”™è¯¯ä¿¡æ¯
  connectionStatus: 'connected' | 'disconnected' | 'reconnecting'; // è¿æ¥çŠ¶æ€
}
```

### ğŸ’¾ CacheState æ¥å£

ç¼“å­˜çŠ¶æ€ç®¡ç†ã€‚

```typescript
export interface CacheState {
  lastUpdated: Date;       // æœ€åæ›´æ–°æ—¶é—´
  isValid: boolean;        // ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
  source: 'memory' | 'localStorage' | 'network'; // æ•°æ®æ¥æº
}
```

### ğŸ“ˆ PerformanceMetrics æ¥å£

æ€§èƒ½ç›‘æ§æŒ‡æ ‡ã€‚

```typescript
export interface PerformanceMetrics {
  loadTime: number;            // é¡µé¢åŠ è½½æ—¶é—´
  searchTime: number;          // æœç´¢è€—æ—¶
  renderTime: number;          // æ¸²æŸ“è€—æ—¶
  cacheHitRate: number;        // ç¼“å­˜å‘½ä¸­ç‡
  memoryUsage: number;         // å†…å­˜ä½¿ç”¨é‡
  totalRequests: number;       // æ€»è¯·æ±‚æ•°
  errorCount: number;          // é”™è¯¯æ¬¡æ•°
  averageResponseTime: number; // å¹³å‡å“åº”æ—¶é—´
  cacheHits: number;           // ç¼“å­˜å‘½ä¸­æ¬¡æ•°
  cacheMisses: number;         // ç¼“å­˜æœªå‘½ä¸­æ¬¡æ•°
  lastUpdated: Date;           // æœ€åæ›´æ–°æ—¶é—´
}
```

### âš™ï¸ UserPreferences æ¥å£

ç”¨æˆ·åå¥½è®¾ç½®ã€‚

```typescript
export interface UserPreferences {
  theme: string;                           // ä¸»é¢˜åç§°
  language: string;                        // è¯­è¨€è®¾ç½®
  itemsPerPage: number;                    // æ¯é¡µæ˜¾ç¤ºæ•°é‡
  defaultSortBy: SearchFilters['sortBy'];  // é»˜è®¤æ’åºå­—æ®µ
  defaultSortOrder: SearchFilters['sortOrder']; // é»˜è®¤æ’åºæ–¹å‘
  autoSave: boolean;                       // è‡ªåŠ¨ä¿å­˜
  cacheEnabled: boolean;                   // å¯ç”¨ç¼“å­˜
}
```

---

## APIå’Œå“åº”ç±»å‹

### ğŸŒ ApiResponse æ¥å£

é€šç”¨çš„ API å“åº”æ ¼å¼ã€‚

```typescript
export interface ApiResponse<T = any> {
  success: boolean;        // æ“ä½œæ˜¯å¦æˆåŠŸ
  data?: T;               // å“åº”æ•°æ®ï¼ˆæ³›å‹ï¼‰
  error?: string;         // é”™è¯¯ä¿¡æ¯
  message?: string;       // æç¤ºä¿¡æ¯
  timestamp: Date;        // å“åº”æ—¶é—´æˆ³
}
```

### ğŸ—„ï¸ DBResult æ¥å£

æ•°æ®åº“æ“ä½œç»“æœã€‚

```typescript
export interface DBResult<T = any> {
  success: boolean;        // æ“ä½œæ˜¯å¦æˆåŠŸ
  data?: T;               // è¿”å›æ•°æ®ï¼ˆæ³›å‹ï¼‰
  error?: string;         // é”™è¯¯ä¿¡æ¯
  timestamp: Date;        // æ“ä½œæ—¶é—´æˆ³
}
```

### ğŸ“¦ BatchResult æ¥å£

æ‰¹é‡æ“ä½œç»“æœã€‚

```typescript
export interface BatchResult {
  success: number;         // æˆåŠŸæ•°é‡
  failed: number;          // å¤±è´¥æ•°é‡
  errors: string[];        // é”™è¯¯ä¿¡æ¯åˆ—è¡¨
  results: DBResult[];     // è¯¦ç»†ç»“æœåˆ—è¡¨
}
```

### ğŸ“¤ ExportData æ¥å£

æ•°æ®å¯¼å‡ºæ ¼å¼ã€‚

```typescript
export interface ExportData {
  version: string;         // å¯¼å‡ºæ ¼å¼ç‰ˆæœ¬
  exportDate: Date;        // å¯¼å‡ºæ—¶é—´
  images: ImageData[];     // å›¾ç‰‡æ•°æ®
  tags: Tag[];            // æ ‡ç­¾æ•°æ®
  metadata: {             // å…ƒæ•°æ®
    totalImages: number;
    totalTags: number;
  };
}
```

---

## UIå’Œäº¤äº’ç±»å‹

### ğŸ“ æ–‡ä»¶ä¸Šä¼ ç›¸å…³ç±»å‹

#### UploadProgress æ¥å£

```typescript
export interface UploadProgress {
  loaded: number;          // å·²ä¸Šä¼ å­—èŠ‚æ•°
  total: number;           // æ€»å­—èŠ‚æ•°
  percentage: number;      // ä¸Šä¼ ç™¾åˆ†æ¯”
  speed: number;           // ä¸Šä¼ é€Ÿåº¦ï¼ˆå­—èŠ‚/ç§’ï¼‰
  timeRemaining: number;   // å‰©ä½™æ—¶é—´ï¼ˆç§’ï¼‰
}
```

#### UploadResult æ¥å£

```typescript
export interface UploadResult {
  success: boolean;        // ä¸Šä¼ æ˜¯å¦æˆåŠŸ
  url?: string;           // æ–‡ä»¶URL
  thumbnailUrl?: string;  // ç¼©ç•¥å›¾URL
  error?: string;         // é”™è¯¯ä¿¡æ¯
  metadata?: {            // æ–‡ä»¶å…ƒæ•°æ®
    width: number;
    height: number;
    fileSize: number;
    format: string;
  };
}
```

#### UploadValidationResult æ¥å£

```typescript
export interface UploadValidationResult {
  isValid: boolean;        // éªŒè¯æ˜¯å¦é€šè¿‡
  errors: string[];        // é”™è¯¯ä¿¡æ¯åˆ—è¡¨
  warnings: string[];      // è­¦å‘Šä¿¡æ¯åˆ—è¡¨
}
```

#### FileUploadOptions æ¥å£

```typescript
export interface FileUploadOptions {
  maxSize?: number;        // æœ€å¤§æ–‡ä»¶å¤§å°
  allowedFormats?: string[]; // å…è®¸çš„æ–‡ä»¶æ ¼å¼
  generateThumbnail?: boolean; // æ˜¯å¦ç”Ÿæˆç¼©ç•¥å›¾
  quality?: number;        // å‹ç¼©è´¨é‡
}
```

### ğŸ§ ç›‘å¬å™¨é€‰é¡¹

```typescript
export interface ListenerOptions {
  useCache?: boolean;      // æ˜¯å¦ä½¿ç”¨ç¼“å­˜
  cacheTimeout?: number;   // ç¼“å­˜è¶…æ—¶æ—¶é—´
}
```

---

## å·¥å…·ç±»å‹å’Œå¸¸é‡

### ğŸ”§ å·¥å…·ç±»å‹

```typescript
// å¯æ’åºå­—æ®µç±»å‹
export type SortableFields = keyof Pick<
  ImageData,
  'createdAt' | 'updatedAt' | 'title'
>;

// å¯è¿‡æ»¤å­—æ®µç±»å‹
export type FilterableFields = keyof Pick<ImageData, 'title' | 'tags'>;

// å¯æœç´¢å®ä½“ç±»å‹
export type SearchableEntities = ImageData | Tag;

// è¿æ¥çŠ¶æ€ç±»å‹
export type ConnectionStatus = 'connected' | 'disconnected' | 'reconnecting';

// æ•°æ®å˜æ›´äº‹ä»¶ç±»å‹
export type DataChangeEvent = {
  type: 'create' | 'update' | 'delete';
  entity: 'image' | 'tag';
  id: string;
  data?: any;
};
```

### ğŸ“Š å¸¸é‡å®šä¹‰

```typescript
// åˆ†é¡µç›¸å…³
export const DEFAULT_PAGINATION_LIMIT = 20;

// æ–‡ä»¶ä¸Šä¼ ç›¸å…³
export const MAX_UPLOAD_SIZE = 10 * 1024 * 1024; // 10MB
export const SUPPORTED_IMAGE_FORMATS = [
  'jpg', 'jpeg', 'png', 'gif', 'webp', 'svg'
] as const;

// é»˜è®¤æç¤ºè¯å—æ¨¡æ¿
export const DEFAULT_PROMPT_BLOCKS = [
  { title: 'é£æ ¼', text: '' },
  { title: 'ä¸»ä½“', text: '' },
  { title: 'åœºæ™¯', text: '' },
] as const;
```

---

## é”™è¯¯å¤„ç†ç±»å‹

### âš ï¸ è‡ªå®šä¹‰é”™è¯¯ç±»

#### AppError åŸºç¡€é”™è¯¯ç±»

```typescript
export class AppError extends Error {
  constructor(
    message: string,
    public code: string,
    public details?: any
  ) {
    super(message);
    this.name = 'AppError';
  }
}
```

#### ValidationError éªŒè¯é”™è¯¯

```typescript
export class ValidationError extends AppError {
  constructor(message: string, details?: any) {
    super(message, 'VALIDATION_ERROR', details);
    this.name = 'ValidationError';
  }
}
```

#### NetworkError ç½‘ç»œé”™è¯¯

```typescript
export class NetworkError extends AppError {
  constructor(message: string, details?: any) {
    super(message, 'NETWORK_ERROR', details);
    this.name = 'NetworkError';
  }
}
```

#### CacheError ç¼“å­˜é”™è¯¯

```typescript
export class CacheError extends AppError {
  constructor(message: string, details?: any) {
    super(message, 'CACHE_ERROR', details);
    this.name = 'CacheError';
  }
}
```

---

## ç±»å‹å®ˆå«å‡½æ•°

### ğŸ›¡ï¸ è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥

#### isImageData å‡½æ•°

```typescript
export function isImageData(obj: any): obj is ImageData {
  return (
    obj &&
    typeof obj.id === 'string' &&
    typeof obj.url === 'string' &&
    typeof obj.title === 'string'
  );
}
```

#### isTag å‡½æ•°

```typescript
export function isTag(obj: any): obj is Tag {
  return (
    obj &&
    typeof obj.id === 'string' &&
    typeof obj.name === 'string' &&
    typeof obj.color === 'string'
  );
}
```

#### getColorTheme å‡½æ•°

```typescript
export function getColorTheme(themeName: string): ColorTheme {
  return (
    COLOR_THEMES.find((theme) => theme.name === themeName) || COLOR_THEMES[0]
  );
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// ç±»å‹å®ˆå«ä½¿ç”¨
if (isImageData(data)) {
  // æ­¤æ—¶ data è¢«æ¨æ–­ä¸º ImageData ç±»å‹
  console.log(data.title); // ç±»å‹å®‰å…¨
}

// ä¸»é¢˜è·å–
const theme = getColorTheme('warm');
console.log(theme.primary); // '#f97316'
```

---

## ä½¿ç”¨æŒ‡å—

### ğŸ“ æœ€ä½³å®è·µ

#### 1. ç±»å‹å¯¼å…¥

```typescript
// æ¨èï¼šæŒ‰éœ€å¯¼å…¥
import { ImageData, Tag, SearchFilters } from '@/types';

// é¿å…ï¼šå…¨é‡å¯¼å…¥
import * as Types from '@/types';
```

#### 2. æ¥å£æ‰©å±•

```typescript
// æ‰©å±•ç°æœ‰æ¥å£
interface ExtendedImageData extends ImageData {
  customField: string;
}

// ä½¿ç”¨æ³›å‹
interface CustomApiResponse<T> extends ApiResponse<T> {
  customMeta: any;
}
```

#### 3. ç±»å‹æ–­è¨€

```typescript
// ä½¿ç”¨ç±»å‹å®ˆå«ï¼ˆæ¨èï¼‰
if (isImageData(data)) {
  // ç±»å‹å®‰å…¨çš„æ“ä½œ
}

// ç±»å‹æ–­è¨€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
const image = data as ImageData;
```

#### 4. å¯é€‰å­—æ®µå¤„ç†

```typescript
// ä½¿ç”¨å¯é€‰é“¾
const count = image.usageCount ?? 0;
const thumbnail = image.thumbnailUrl || image.url;

// ç±»å‹ç¼©çª„
if (image.usageCount !== undefined) {
  // usageCount åœ¨æ­¤ä½œç”¨åŸŸå†…ä¸ä¸º undefined
}
```

### ğŸ”„ ç‰ˆæœ¬å…¼å®¹æ€§

#### å‘åå…¼å®¹ç­–ç•¥

1. **æ–°å¢å­—æ®µ**: ä½¿ç”¨å¯é€‰å±æ€§
2. **å­—æ®µé‡å‘½å**: ä¿ç•™æ—§å­—æ®µå¹¶æ ‡è®°ä¸º `@deprecated`
3. **ç±»å‹å˜æ›´**: ä½¿ç”¨è”åˆç±»å‹è¿‡æ¸¡
4. **æ¥å£æ‹†åˆ†**: ä¿æŒåŸæ¥å£å¹¶åˆ›å»ºæ–°æ¥å£

#### è¿ç§»æŒ‡å—

```typescript
// ç‰ˆæœ¬ 1.0
interface OldImageData {
  id: string;
  url: string;
  title: string;
}

// ç‰ˆæœ¬ 2.0 - å‘åå…¼å®¹
interface ImageData {
  id: string;
  url: string;
  title: string;
  prompts?: Prompt[];  // æ–°å¢å¯é€‰å­—æ®µ
  tags?: Tag[];        // æ–°å¢å¯é€‰å­—æ®µ
}

// ç‰ˆæœ¬ 3.0 - æ¸è¿›å¼è¿ç§»
interface ImageData {
  id: string;
  url: string;
  title: string;
  prompts: Prompt[];   // å˜ä¸ºå¿…éœ€å­—æ®µ
  tags: Tag[];         // å˜ä¸ºå¿…éœ€å­—æ®µ
}
```

### ğŸ§ª æµ‹è¯•æ”¯æŒ

#### ç±»å‹æµ‹è¯•

```typescript
// ç±»å‹æµ‹è¯•ç¤ºä¾‹
type TestImageData = {
  id: string;
  url: string;
  title: string;
  prompts: Prompt[];
  tags: Tag[];
  createdAt: string;
  updatedAt: string;
};

// ç¡®ä¿ç±»å‹å…¼å®¹æ€§
type AssertImageDataCompatible = ImageData extends TestImageData ? true : false;
```

#### Mock æ•°æ®ç”Ÿæˆ

```typescript
// åˆ›å»ºæµ‹è¯•æ•°æ®çš„å·¥å‚å‡½æ•°
export function createMockImageData(overrides?: Partial<ImageData>): ImageData {
  return {
    id: 'test-id',
    url: 'https://example.com/image.jpg',
    title: 'Test Image',
    prompts: [],
    tags: [],
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
    ...overrides,
  };
}
```

### ğŸ“š æ–‡æ¡£ç»´æŠ¤

#### ç±»å‹æ–‡æ¡£åŒ–

```typescript
/**
 * å›¾ç‰‡æ•°æ®æ¥å£
 * @description å®šä¹‰å›¾ç‰‡çš„å®Œæ•´æ•°æ®ç»“æ„
 * @example
 * ```typescript
 * const image: ImageData = {
 *   id: 'img-123',
 *   url: 'https://example.com/image.jpg',
 *   title: 'Beautiful Sunset',
 *   prompts: [],
 *   tags: [],
 *   createdAt: '2024-01-01T00:00:00Z',
 *   updatedAt: '2024-01-01T00:00:00Z'
 * };
 * ```
 */
export interface ImageData {
  // ... å­—æ®µå®šä¹‰
}
```

#### å˜æ›´æ—¥å¿—

ç»´æŠ¤ç±»å‹å®šä¹‰çš„å˜æ›´å†å²ï¼š

- **v1.0.0**: åˆå§‹ç±»å‹å®šä¹‰
- **v1.1.0**: æ·»åŠ  `usageCount` å¯é€‰å­—æ®µ
- **v1.2.0**: æ·»åŠ  `isLocal` å’Œ `isUploading` çŠ¶æ€å­—æ®µ
- **v2.0.0**: é‡æ„ `prompts` å­—æ®µä¸ºæ•°ç»„ç±»å‹

---

## æ€»ç»“

### ğŸ¯ ç±»å‹ç³»ç»Ÿç‰¹ç‚¹

1. **å®Œæ•´æ€§**: è¦†ç›–åº”ç”¨çš„æ‰€æœ‰æ•°æ®ç»“æ„
2. **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„å‘½åå’Œç»“æ„è§„èŒƒ
3. **æ‰©å±•æ€§**: æ”¯æŒæœªæ¥åŠŸèƒ½çš„æ‰©å±•
4. **å®‰å…¨æ€§**: æä¾›è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
5. **æ–‡æ¡£åŒ–**: è¯¦ç»†çš„æ³¨é‡Šå’Œä½¿ç”¨ç¤ºä¾‹

### ğŸ”„ æŒç»­æ”¹è¿›

- å®šæœŸå®¡æŸ¥ç±»å‹å®šä¹‰çš„åˆç†æ€§
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´æ¥å£è®¾è®¡
- ä¿æŒå‘åå…¼å®¹æ€§
- å®Œå–„ç±»å‹æµ‹è¯•è¦†ç›–
- æ›´æ–°æ–‡æ¡£å’Œç¤ºä¾‹

### ğŸ“‹ ç»´æŠ¤æ¸…å•

- [ ] å®šæœŸæ£€æŸ¥ç±»å‹å®šä¹‰çš„ä½¿ç”¨æƒ…å†µ
- [ ] æ›´æ–°è¿‡æ—¶çš„ç±»å‹å®šä¹‰
- [ ] æ·»åŠ æ–°åŠŸèƒ½çš„ç±»å‹æ”¯æŒ
- [ ] å®Œå–„ç±»å‹æµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£å’Œç¤ºä¾‹

---

**æ–‡æ¡£ç»´æŠ¤è€…**: å‰ç«¯å¼€å‘å›¢é˜Ÿ  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024-01-01  

*æœ¬æ–‡æ¡£å°†éšç€é¡¹ç›®çš„å‘å±•æŒç»­æ›´æ–°å’Œå®Œå–„ã€‚*