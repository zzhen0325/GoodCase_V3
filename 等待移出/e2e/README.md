# E2E æµ‹è¯•å¥—ä»¶

è¿™æ˜¯ä¸€ä¸ªå…¨é¢çš„ç«¯åˆ°ç«¯æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºæµ‹è¯•å›¾ç‰‡ä¸Šä¼ ã€æ•°æ®å…³è”å’ŒCRUDæ“ä½œåŠŸèƒ½ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
tests/e2e/
â”œâ”€â”€ comprehensive-crud.spec.ts    # å®Œæ•´çš„CRUDåŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ quick-smoke.spec.ts           # å¿«é€Ÿå†’çƒŸæµ‹è¯•
â”œâ”€â”€ run-tests.sh                  # æµ‹è¯•è¿è¡Œè„šæœ¬
â”œâ”€â”€ utils/                        # æµ‹è¯•å·¥å…·ç±»
â”‚   â”œâ”€â”€ TestDataManager.ts        # æµ‹è¯•æ•°æ®ç®¡ç†å™¨
â”‚   â”œâ”€â”€ ApiTestHelper.ts          # APIæµ‹è¯•è¾…åŠ©å·¥å…·
â”‚   â””â”€â”€ TestImageGenerator.ts     # æµ‹è¯•å›¾ç‰‡ç”Ÿæˆå™¨
â””â”€â”€ fixtures/                     # æµ‹è¯•æ•°æ®å’Œé…ç½®
    â”œâ”€â”€ test-config.ts            # æµ‹è¯•é…ç½®
    â””â”€â”€ test-data-seeds.ts        # æµ‹è¯•æ•°æ®ç§å­
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

### 3. è¿è¡Œæµ‹è¯•

#### å¿«é€Ÿå†’çƒŸæµ‹è¯•ï¼ˆæ¨èï¼‰
```bash
./tests/e2e/run-tests.sh -s
```

#### å®Œæ•´ç»¼åˆæµ‹è¯•
```bash
./tests/e2e/run-tests.sh -f
```

#### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
./tests/e2e/run-tests.sh -a
```

## ğŸ“‹ æµ‹è¯•è„šæœ¬é€‰é¡¹

### åŸºæœ¬é€‰é¡¹

| é€‰é¡¹ | æè¿° |
|------|------|
| `-s, --smoke` | è¿è¡Œå¿«é€Ÿå†’çƒŸæµ‹è¯• |
| `-f, --full` | è¿è¡Œå®Œæ•´çš„ç»¼åˆæµ‹è¯• |
| `-a, --all` | è¿è¡Œæ‰€æœ‰æµ‹è¯• |
| `-h, --help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |

### é«˜çº§é€‰é¡¹

| é€‰é¡¹ | æè¿° |
|------|------|
| `-d, --debug` | å¯ç”¨è°ƒè¯•æ¨¡å¼ |
| `-v, --verbose` | å¯ç”¨è¯¦ç»†è¾“å‡º |
| `-k, --keep-data` | ä¿ç•™æµ‹è¯•æ•°æ®ï¼ˆç”¨äºè°ƒè¯•ï¼‰ |
| `-p, --parallel` | å¹¶è¡Œè¿è¡Œæµ‹è¯• |
| `-r, --report` | ç”ŸæˆHTMLæŠ¥å‘Š |
| `-c, --clean` | æ¸…ç†æµ‹è¯•ç¯å¢ƒ |

### ä½¿ç”¨ç¤ºä¾‹

```bash
# è¿è¡Œå¿«é€Ÿæµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š
./tests/e2e/run-tests.sh -s -r

# è¿è¡Œå®Œæ•´æµ‹è¯•ï¼Œå¯ç”¨è°ƒè¯•å’Œè¯¦ç»†è¾“å‡º
./tests/e2e/run-tests.sh -f -d -v

# å¹¶è¡Œè¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š
./tests/e2e/run-tests.sh -a -p -r

# æ¸…ç†æµ‹è¯•ç¯å¢ƒ
./tests/e2e/run-tests.sh -c
```

## ğŸ§ª æµ‹è¯•å†…å®¹

### å¿«é€Ÿå†’çƒŸæµ‹è¯• (`quick-smoke.spec.ts`)

- âœ… åŸºæœ¬CRUDæ“ä½œæµç¨‹
- âœ… APIå“åº”æ ¼å¼éªŒè¯
- âœ… é”™è¯¯å¤„ç†éªŒè¯
- âœ… æ•°æ®å…³è”ä¸€è‡´æ€§
- âœ… æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- âœ… åˆ†é¡µåŠŸèƒ½

**é¢„è®¡è¿è¡Œæ—¶é—´**: 2-3åˆ†é’Ÿ

### å®Œæ•´ç»¼åˆæµ‹è¯• (`comprehensive-crud.spec.ts`)

#### æ ‡ç­¾åˆ†ç±»CRUDæµ‹è¯•
- åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤åˆ†ç±»
- éªŒè¯é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæ¡ä»¶
- æµ‹è¯•åˆ†ç±»åˆ—è¡¨å’Œåˆ†é¡µ

#### æ ‡ç­¾CRUDæµ‹è¯•
- åˆ›å»ºã€è¯»å–ã€æ›´æ–°æ ‡ç­¾
- æµ‹è¯•æ ‡ç­¾ä¸åˆ†ç±»çš„å…³è”
- æ‰¹é‡æ“ä½œæµ‹è¯•
- é‡å¤åç§°å†²çªå¤„ç†

#### å›¾ç‰‡ä¸Šä¼ æµ‹è¯•
- æ”¯æŒPNGã€JPEGã€WebPæ ¼å¼
- æ–‡ä»¶å¤§å°é™åˆ¶éªŒè¯
- æ— æ•ˆæ ¼å¼å¤„ç†
- ä¸Šä¼ å“åº”éªŒè¯

#### å›¾ç‰‡å…ƒæ•°æ®ç®¡ç†
- æ·»åŠ å®Œæ•´å›¾ç‰‡ä¿¡æ¯
- è‡ªåŠ¨åˆ›å»ºæ–°æ ‡ç­¾å’Œåˆ†ç±»
- æ›´æ–°å›¾ç‰‡ä¿¡æ¯
- è·å–å›¾ç‰‡è¯¦æƒ…

#### æç¤ºè¯å—ç®¡ç†
- åˆ›å»ºå’Œæ›´æ–°æç¤ºè¯å—
- é¢œè‰²æšä¸¾éªŒè¯
- å†…å®¹é•¿åº¦é™åˆ¶
- é¡ºåºç®¡ç†

#### æ•°æ®ä¸€è‡´æ€§æµ‹è¯•
- æ ‡ç­¾-åˆ†ç±»å…³è”éªŒè¯
- å›¾ç‰‡-æ ‡ç­¾å…³è”éªŒè¯
- çº§è”åˆ é™¤å½±å“æµ‹è¯•

#### æ€§èƒ½å’Œè¾¹ç•Œæµ‹è¯•
- åˆ†é¡µå‚æ•°è¾¹ç•Œ
- å¹¶å‘æ“ä½œæµ‹è¯•
- æ•°æ®å®Œæ•´æ€§éªŒè¯

**é¢„è®¡è¿è¡Œæ—¶é—´**: 8-12åˆ†é’Ÿ

## ğŸ› ï¸ å·¥å…·ç±»è¯´æ˜

### TestDataManager

è´Ÿè´£ç®¡ç†æµ‹è¯•æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸï¼š

```typescript
// åˆ›å»ºæµ‹è¯•åˆ†ç±»
const category = await testDataManager.createTestCategory({
  name: 'æµ‹è¯•åˆ†ç±»',
  color: 'pink'
});

// ä¸Šä¼ æµ‹è¯•å›¾ç‰‡
const image = await testDataManager.uploadTestImage(
  imagePath, 
  'image/png'
);

// æ¸…ç†æµ‹è¯•æ•°æ®
await testDataManager.cleanupTestData();
```

### ApiTestHelper

æä¾›APIæµ‹è¯•çš„è¾…åŠ©æ–¹æ³•ï¼š

```typescript
// éªŒè¯æˆåŠŸå“åº”
await apiHelper.expectSuccessResponse(result);

// éªŒè¯é”™è¯¯å“åº”
await apiHelper.expectValidationError(result, 'fieldName');

// è·å–æ‰€æœ‰åˆ†ç±»
const categories = await apiHelper.getAllCategories();
```

### TestImageGenerator

ç”Ÿæˆå„ç§æµ‹è¯•å›¾ç‰‡ï¼š

```typescript
// åˆ›å»ºæ ‡å‡†æµ‹è¯•å›¾ç‰‡é›†
const images = imageGenerator.createStandardTestImages();

// ç”Ÿæˆå¤§æ–‡ä»¶ç”¨äºæµ‹è¯•é™åˆ¶
const largeFile = imageGenerator.createLargeFile();
```

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `API_BASE_URL` | APIåŸºç¡€URL | `http://localhost:3000` |
| `TEST_VERBOSE` | å¯ç”¨è¯¦ç»†æ—¥å¿— | `false` |
| `KEEP_TEST_DATA` | ä¿ç•™æµ‹è¯•æ•°æ® | `false` |
| `SKIP_CLEANUP` | è·³è¿‡æ¸…ç†æ­¥éª¤ | `false` |

### æµ‹è¯•é…ç½® (`test-config.ts`)

```typescript
export const TEST_CONFIG = {
  MAX_FILE_SIZE: 10 * 1024 * 1024, // 10MB
  SUPPORTED_IMAGE_FORMATS: ['image/png', 'image/jpeg', 'image/webp'],
  DEFAULT_PAGE_SIZE: 20,
  API_TIMEOUT: 10000
};
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

### ç”ŸæˆHTMLæŠ¥å‘Š

```bash
./tests/e2e/run-tests.sh -s -r
```

æŠ¥å‘Šå°†ç”Ÿæˆåœ¨ `playwright-report/` ç›®å½•ä¸­ï¼ŒåŒ…å«ï¼š

- æµ‹è¯•æ‰§è¡Œç»“æœ
- å¤±è´¥æˆªå›¾
- æ‰§è¡Œæ—¶é—´ç»Ÿè®¡
- é”™è¯¯è¯¦æƒ…

### æŸ¥çœ‹æŠ¥å‘Š

```bash
npx playwright show-report
```

## ğŸ› è°ƒè¯•

### å¯ç”¨è°ƒè¯•æ¨¡å¼

```bash
./tests/e2e/run-tests.sh -s -d
```

è°ƒè¯•æ¨¡å¼å°†ï¼š
- å¯ç”¨æµè§ˆå™¨å¯è§†åŒ–
- æ˜¾ç¤ºè¯¦ç»†çš„æ‰§è¡Œæ­¥éª¤
- åœ¨å¤±è´¥æ—¶æš‚åœæ‰§è¡Œ

### ä¿ç•™æµ‹è¯•æ•°æ®

```bash
./tests/e2e/run-tests.sh -s -k
```

è¿™å°†ä¿ç•™æµ‹è¯•è¿‡ç¨‹ä¸­åˆ›å»ºçš„æ•°æ®ï¼Œä¾¿äºæ‰‹åŠ¨æ£€æŸ¥ã€‚

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
./tests/e2e/run-tests.sh -s -v
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æµ‹è¯•è¶…æ—¶

**åŸå› **: æœåŠ¡å™¨å“åº”æ…¢æˆ–ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¢åŠ è¶…æ—¶æ—¶é—´
export API_TIMEOUT=30000
./tests/e2e/run-tests.sh -s
```

#### 2. æ–‡ä»¶æƒé™é”™è¯¯

**åŸå› **: æµ‹è¯•è„šæœ¬æ²¡æœ‰æ‰§è¡Œæƒé™

**è§£å†³æ–¹æ¡ˆ**:
```bash
chmod +x tests/e2e/run-tests.sh
```

#### 3. ä¾èµ–ç¼ºå¤±

**åŸå› **: æœªå®‰è£…Playwrightæˆ–å…¶ä»–ä¾èµ–

**è§£å†³æ–¹æ¡ˆ**:
```bash
npm install
npx playwright install
```

#### 4. ç«¯å£å†²çª

**åŸå› **: 3000ç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨ä¸åŒç«¯å£
export API_BASE_URL=http://localhost:3001
npm run dev -- -p 3001
```

### æ¸…ç†æµ‹è¯•ç¯å¢ƒ

å¦‚æœæµ‹è¯•ç¯å¢ƒå‡ºç°é—®é¢˜ï¼Œå¯ä»¥å®Œå…¨æ¸…ç†ï¼š

```bash
# æ¸…ç†æµ‹è¯•æ–‡ä»¶å’ŒæŠ¥å‘Š
./tests/e2e/run-tests.sh -c

# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install
npx playwright install
```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

### é¢„æœŸæ‰§è¡Œæ—¶é—´

| æµ‹è¯•ç±»å‹ | æ‰§è¡Œæ—¶é—´ | æµ‹è¯•æ•°é‡ |
|----------|----------|----------|
| å¿«é€Ÿå†’çƒŸæµ‹è¯• | 2-3åˆ†é’Ÿ | ~15ä¸ªæµ‹è¯• |
| å®Œæ•´ç»¼åˆæµ‹è¯• | 8-12åˆ†é’Ÿ | ~50ä¸ªæµ‹è¯• |
| æ‰€æœ‰æµ‹è¯• | 10-15åˆ†é’Ÿ | ~65ä¸ªæµ‹è¯• |

### æ€§èƒ½é˜ˆå€¼

- APIå“åº”æ—¶é—´: < 500ms (æ­£å¸¸)
- æ–‡ä»¶ä¸Šä¼ : < 2s (10MBä»¥ä¸‹)
- æ•°æ®åº“æ“ä½œ: < 100ms (å•æ¬¡)

## ğŸ¤ è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•

1. åœ¨ç›¸åº”çš„æµ‹è¯•æ–‡ä»¶ä¸­æ·»åŠ æµ‹è¯•ç”¨ä¾‹
2. ä½¿ç”¨ç°æœ‰çš„å·¥å…·ç±»å’Œé…ç½®
3. ç¡®ä¿æµ‹è¯•å…·æœ‰é€‚å½“çš„æ¸…ç†é€»è¾‘
4. æ·»åŠ å¿…è¦çš„æ–‡æ¡£è¯´æ˜

### ä¿®æ”¹å·¥å…·ç±»

1. ä¿æŒå‘åå…¼å®¹æ€§
2. æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†
3. æ›´æ–°ç›¸å…³æ–‡æ¡£
4. è¿è¡Œæ‰€æœ‰æµ‹è¯•ç¡®ä¿æ— ç ´åæ€§å˜æ›´

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-19)

- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… å®Œæ•´çš„CRUDæµ‹è¯•å¥—ä»¶
- âœ… å¿«é€Ÿå†’çƒŸæµ‹è¯•
- âœ… æµ‹è¯•å·¥å…·ç±»å’Œé…ç½®
- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
- âœ… è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜

---

## ğŸ“ æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥æµ‹è¯•æ—¥å¿—å’ŒæŠ¥å‘Š
3. ç¡®è®¤ç¯å¢ƒé…ç½®æ­£ç¡®
4. è”ç³»å¼€å‘å›¢é˜Ÿè·å–æ”¯æŒ

**ç¥æµ‹è¯•æ„‰å¿«ï¼** ğŸ‰